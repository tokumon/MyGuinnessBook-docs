# 統計を計算できる - User Story

## 📖 概要

| 項目 | 内容 |
|------|------|
| As a | ギネス記録のユーザー |
| I want to | 記録データから様々な統計情報を自動計算できる |
| so that | 記録の分析や目標設定に活用できる |


## 🔄 振る舞い

### 基本統計を計算する

| 項目 | 内容 |
|------|------|
| GIVEN | ユーザーが記録データを持っている |
| WHEN | 統計画面にアクセスする |
| THEN | 総記録数、平均記録数、最多記録日などの基本統計を表示する |
| AND | 計算結果をリアルタイムで更新する |

### 期間別統計を計算する

| 項目 | 内容 |
|------|------|
| GIVEN | ユーザーが特定の期間を選択している |
| WHEN | 期間を変更する |
| THEN | 選択期間に応じた統計を再計算する |
| AND | 前期間との比較も表示する |


## ✅ 受け入れ基準

### 必須機能
- [ ] 総記録数を計算できる
- [ ] 日別・週別・月別の記録数を計算できる
- [ ] 平均記録数（日別・週別・月別）を計算できる
- [ ] 最多記録日とその記録数を計算できる
- [ ] 記録の連続日数を計算できる
- [ ] カテゴリ別の記録数を計算できる
- [ ] 記録の傾向（増加・減少・安定）を分析できる
- [ ] 目標達成率を計算できる

### エラー・バリデーション
| エラー種別 | 発生条件 | 期待される動作 | エラーメッセージ |
|------------|----------|----------------|------------------|
| データなし | 記録データが存在しない | 統計を0で表示 | "統計データがありません" |
| 計算エラー | データ形式が不正 | エラーをログに記録 | "統計の計算中にエラーが発生しました" |


## 🎨 UI/UX要件

### 関連するデザインデータ
統計画面 - MyGuinnessBook

### 主なUXフロー
1. 統計画面にアクセス
2. 統計計算が自動実行される
3. 計算結果がカード形式で表示される
4. 期間を変更すると再計算される
5. 詳細統計をタップして詳細画面に遷移

### 主なコンポーネント
- 統計カード（総記録数、平均記録数など）
- 期間選択セレクター
- 統計詳細ボタン
- 比較表示エリア

### 主なユーザーフィードバック
- 計算結果を分かりやすく表示
- 数値の変化を視覚的に表現
- ローディング中は適切なインジケーターを表示

### 主なアクセシビリティ要件
- 統計数値をスクリーンリーダーで読み上げ可能
- 数値の単位を明確に表示
- 色だけでなく記号でも変化を表現


## 🔗 関連情報

### 依存関係
- **前提条件**: 記録入力機能、データ管理機能
- **後続機能**: グラフ表示機能、統計レポート生成機能

### 技術的考慮事項
- 大量データでも高速に計算できるよう最適化
- 計算結果をキャッシュしてパフォーマンスを向上
- 数値の精度を適切に管理
- メモリ使用量を考慮した計算アルゴリズム


## 📝 備考
- 統計計算は非同期で実行し、UIをブロックしない
- 将来的には機械学習による予測統計も検討
- 計算結果はローカルストレージにキャッシュ
- 統計の更新頻度は設定で調整可能 