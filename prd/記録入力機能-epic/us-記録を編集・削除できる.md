# 記録を編集・削除できる - User Story

## 📖 概要

| 項目 | 内容 |
|------|------|
| As a | 記録好きなユーザー |
| I want to | 記録を編集・削除できる |
| so that | 間違いを修正したり、不要な記録を整理できる |


## 🔄 振る舞い

### 記録編集シナリオ

| 項目 | 内容 |
|------|------|
| GIVEN | ユーザーが記録詳細画面にいる |
| WHEN | 「編集」ボタンを押す |
| THEN | 編集画面が表示される |
| AND | 既存の内容が入力済みで表示される |

### 記録保存シナリオ

| 項目 | 内容 |
|------|------|
| GIVEN | ユーザーが記録を編集している |
| WHEN | 「保存」ボタンを押す |
| THEN | 変更内容が保存される |
| AND | 更新日時が記録される |

### 記録削除シナリオ

| 項目 | 内容 |
|------|------|
| GIVEN | ユーザーが記録詳細画面にいる |
| WHEN | 「削除」ボタンを押す |
| THEN | 削除確認ダイアログが表示される |
| AND | 確認後に記録が削除される |


## ✅ 受け入れ基準

### 必須機能
- [ ] 記録内容の編集機能
- [ ] 画像の追加・削除・変更
- [ ] 記録の削除機能
- [ ] 編集履歴の記録
- [ ] 削除確認機能

### エラー・バリデーション
| エラー種別 | 発生条件 | 期待される動作 | エラーメッセージ |
|------------|----------|----------------|------------------|
| 保存エラー | 編集内容の保存に失敗 | エラーメッセージ表示 | 「保存に失敗しました」 |
| 削除エラー | 記録の削除に失敗 | 削除をキャンセル | 「削除に失敗しました」 |
| localStorage容量不足 | 保存時に容量不足 | 古いデータを削除して再試行 | 「古いデータを削除して保存します」 |
| ファイルサイズ超過 | 新しい画像が1MB超過 | アップロード拒否 | 「ファイルサイズは1MB以下にしてください」 |


## 🎨 UI/UX要件

### 主なUXフロー
1. 記録詳細画面で「編集」ボタンを選択
2. 編集画面で内容を修正
3. 保存ボタンで変更を確定
4. 削除時は確認ダイアログを表示
5. 完了後は履歴画面に戻る

### 主なコンポーネント
- 編集フォーム
- 削除確認ダイアログ
- 変更履歴表示
- 保存/キャンセルボタン
- 画像編集機能

### 主なユーザーフィードバック
- 編集内容の変更点表示
- 保存完了の成功メッセージ
- 削除前の最終確認
- 編集履歴の視覚的表示

### 主なアクセシビリティ要件
- 編集フォームの適切なラベル
- 削除確認の音声読み上げ
- キーボードナビゲーション対応
- 高コントラストモード対応


## 🔗 関連情報

### 依存関係
- **前提条件**: 記録入力機能、記録履歴表示機能
- **後続機能**: 記録のバージョン管理機能

### 技術的考慮事項
- localStorageでの編集内容の差分管理
- Base64画像の効率的な更新処理
- 削除データの復元機能（localStorage内）
- localStorage容量制限への対応

## 📝 備考
- 編集履歴はlocalStorage容量内で一定期間保持
- 削除した記録は一定期間復元可能（localStorage内）
- 将来的に記録のバージョン管理機能を追加予定
- localStorage容量制限を考慮した履歴管理 